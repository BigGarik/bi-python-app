{% extends 'base123.html' %}
{% load web_tags %}
{% load static %}
{% load i18n %}

{% block center_col %}
<link rel="stylesheet" href="{% static 'web/css/profile.css' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-b1buSpv0JPw+Ic44JqBxZB8l+1cXpRK52fSlCHnEyZ/jJ8R2oG8rUwZ8t5yIrJvZ" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha384-cVJb8dQ6z+XoNX6FqZMhDIxQ1b/k7tJsOqW2bQNsN2gNV7P6LEHS2RRsKdf4EoAg" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-eAqHgH66lTjivfTl6o5x2R7FSP5Qb5H1sVaVYQ4H9Fti5Aq3ck+CpK5+JeIMI99e5" crossorigin="anonymous"></script>



<style>
 
    

    
    @media (max-width: 768px ) {
    
        .prof-page-pic-cont img {
            min-height: 100px !important;
            min-width: 100px !important;
        }

   

    }
    
    @media (min-width: 769px ) {
        .prof-page-pic-cont img {
            min-height: 130px !important;
            min-width: 130px !important;
        }
  

    }

    
</style>

    <div class="prof-page-cont">

        <a href="{% url 'index' %}" class="to-main-page">
            <i class="bi bi-chevron-left chevro-left-css" ></i>
            &nbsp;{% trans 'ToMainPageLabel' %}
        </a>

        <div class="profile-info-cont">

            <div class="col-12 top-half">

                <div class=" col-sm-3 prof-page-pic-cont">
                    <img src="{{ request.user.profile.avatar.url }}" alt="Avatar"
                         style="border-radius: 50%;width: 80px;height: 80px;object-fit: cover;">
                </div>

                <div class=" col-sm-9  profile-information-cont">

                    <div class="user-display-name">
                        {{ request.user.first_name }} {{ request.user.last_name }}
                    </div>

                    <div class="user-rating-cont">

                        <div class="user-rating">{% trans 'RatingLabel' %}  {{ rating }} &nbsp;</div>

                        <div class="user-rate-and-stars">
                            {% for ch in filled_stars_chipher %}
                                {% if ch == 'f' %}
                                    <i class="bi bi-star-fill" style=" color: #e9be50; padding: 0 2px 0 2px"></i>
                                {% elif ch == 'h' %}
                                    <i class="bi bi-star-half" style=" color: #e9be50; padding: 0 2px 0 2px"></i>
                                {% elif ch == 'e' %}
                                    <i class="bi bi-star" style=" color: #e9be50; padding: 0 2px 0 2px"></i>
                                {% endif %}
                            {% endfor %}
                        </div>

                    </div>

                    <div class="user-category-cont">

                        <div class="user-category">Эксперт в области:</div>

                        {% for exp_category in request.user.expertprofile.expert_categories.all %}
                             <div class="user-catagory-highlight">
                                {{ exp_category.name }}
                             </div>
                        {% endfor %}

                    </div>

                    <div class="user-stats">

                        {{ experts_articles_count }} {% get_write_phrase experts_articles_count 'статья статьи статей' %}
                        •
                        {{ experts_researches_count }} {% get_write_phrase experts_researches_count 'исследование исследования исследований' %}
                        • 24 отзыва

                    </div>

                    <div class="user-settings">

                        <a href="{% url 'profile_edit' %}" type="button"
                           class="btn prof-settings-btn">
                           {% trans 'EditProfileLabel' %}
                        </a>

                        <form method="post" action="{% url 'logout' %}" >
                            {% csrf_token %}
                            <button class="btn prof-logout-btn" type="submit" >
                                {% trans 'LogoutButtonLabel' %}
                            </button>
                        </form>

                    </div>

                </div>

            </div>

            <div class="bottom-half">

                <div class="bottom-info">

                    <div class="prof-bottom-cont">
                        <span class="bottom-bold-text">{% trans 'EducationLabel' %}: &nbsp;</span>
                        <span class="">{{ request.user.expertprofile.education }}</span>
                    </div>

                    <div class="prof-bottom-cont">

                        <span class="bottom-bold-text">{% trans 'ExperienceLabel' %}:&nbsp;</span>
                        <span class="">{{ request.user.expertprofile.experience }}
                            {% get_write_phrase request.user.expertprofile.experience 'год года лет' %}
                        </span>

                    </div>

                    <div class="prof-about-me-cont">
                        {{ request.user.expertprofile.about }}
                    </div>

                    <div class="prof-bottom-cont">

                        <span class="bottom-bold-text">{% trans 'PricePerHourLabel' %}:&nbsp;</span>
                        <span class=""> {{ request.user.expertprofile.hour_cost }} ₽/час</span>
                    </div>

                </div>

                <div class="prof-content-links-cont">
                  <div class="profile-menu-item" data-content="articles" onclick="showContent('articles')">{% trans 'ArticlesTabLabel' %} &nbsp;<span class="expert-profile-title-content-number">{{ experts_articles_count }}</span></div>
                  <div class="profile-menu-item" data-content="researches" onclick="showContent('researches')">{% trans 'ResearchesTabLabel' %} &nbsp;<span class="expert-profile-title-content-number">{{ experts_researches_count }}</span></div>
                  <div class="profile-menu-item" data-content="questions" onclick="showContent('questions')">{% trans 'QuestionsTabLabel' %} &nbsp;<span class="expert-profile-title-content-number">{{ experts_questions_count }}</span></div>
                  <div class="profile-menu-item" data-content="consultations" onclick="showContent('consultations')">{% trans 'ConsultationsTabLabel' %}</div>
                  <div class="profile-menu-item" data-content="reviews" onclick="showContent('reviews')">{% trans 'ReviewsTabLabel' %}</div>
{#                  <div class="profile-menu-item" data-content="notifications" onclick="showContent('notifications')">Уведомления</div>#}
                </div>
                
                <div id="articles" class="expert-content" style="display: none;">
                    {% for article in experts_articles %}

                        <div class="expert-content-cont">

                            <span class="article-title-loop-exp"><a href="{% url 'article_detail' article.slug %}" style="text-decoration: none;color: #36364b;">{{ article.title }}</a></span>
                            <span class="article-content-loop-exp">{{article.description}}</span> 
                            <span class="link-read-post">
                                <a href="{{ article.get_absolute_url }}" style="color:black;" class="link-read-post">{% trans 'ReadPostLabel' %} &nbsp;
                                    <i class="bi bi-chevron-down" style="color:black; scale:1.3"></i>
                                </a>
                            </span>

                            <div class="article-comments-andshare-cont-exp">
                                <div class="article-comments-exp">
                                    <i class="bi bi-chat-left-text" style="color:grey;"></i>&nbsp; 104
                                </div>
                                <div class="article-share-exp">
                                    <i class="bi bi-calendar2-week" style="color:grey; "></i>&nbsp; {{ article.time_update|custom_time_display }}

                                </div>
                            </div>

                        </div>

                        <hr>

                    {% endfor %}
                </div>
                
                
                <div id="researches" class="expert-content" style="display: none;">
                  <span>test research</span>
                  {% for research in experts_researches %}
                  {% endfor %}
                </div>

                <div id="questions" class="expert-content" style="display: none;">
                  <span>test questions</span>
                  {% for research in experts_researches %}
                  {% endfor %}
                </div>

                <div id="consultations" class="expert-content" style="display: none;">
                  <span>test consultations</span>
                  {% for research in experts_researches %}
                  {% endfor %}
                </div>

                <div id="reviews" class="expert-content" style="display: none;">
                  <span>test reviews</span>
                  {% for research in experts_researches %}
                  {% endfor %}
                </div>
                <div id="notifications" class="expert-content" style="display: none;">
                  <span>test notifications</span>
                  {% for research in experts_researches %}
                  {% endfor %}
                </div>

            </div>
        </div>
    </div>


    <script>
      function showContent(contentId) {
        var contentBlocks = document.getElementsByClassName('expert-content');
    
        for (var i = 0; i < contentBlocks.length; i++) {
          contentBlocks[i].style.display = 'none';
        }
    
        var menuItems = document.getElementsByClassName('profile-menu-item');
    
        for (var i = 0; i < menuItems.length; i++) {
          menuItems[i].classList.remove('selected');
        }
    
        var targetElement = document.getElementById(contentId);
        targetElement.style.display = 'block';
    
        var selectedMenuItem = document.querySelector(`.profile-menu-item[data-content="${contentId}"]`);
        selectedMenuItem.classList.add('selected');
      }
    
      document.addEventListener("DOMContentLoaded", function () {
        showContent('articles');
    
        var currentUrl = window.location.pathname;
        var menuItems = document.getElementsByClassName('profile-menu-item');
    
        for (var i = 0; i < menuItems.length; i++) {
          var contentId = menuItems[i].getAttribute("data-content");
          var href = `#${contentId}`;
    
          if (currentUrl.includes(href)) {
            menuItems[i].classList.add('selected');
            showContent(contentId);
            break;
          }
        }
      });
    </script>
{% endblock %}
