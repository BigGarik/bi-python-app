{% extends 'base123.html' %}
{% load web_tags %}
{% load static %}

{% block center_col %}
<link rel="stylesheet" href="{% static 'web/css/profile.css' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-b1buSpv0JPw+Ic44JqBxZB8l+1cXpRK52fSlCHnEyZ/jJ8R2oG8rUwZ8t5yIrJvZ" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha384-cVJb8dQ6z+XoNX6FqZMhDIxQ1b/k7tJsOqW2bQNsN2gNV7P6LEHS2RRsKdf4EoAg" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-eAqHgH66lTjivfTl6o5x2R7FSP5Qb5H1sVaVYQ4H9Fti5Aq3ck+CpK5+JeIMI99e5" crossorigin="anonymous"></script>


    <div class="prof-page-cont">

        <a href="{% url 'index' %}" class="to-main-page">
            <i class="bi bi-chevron-left chevro-left-css" ></i>
            &nbsp;на главную
        </a>

        <div class="profile-info-cont">

            <div class="top-half">

                <div class="prof-pic-cont">
                    <img src="{{ request.user.profile.avatar.url }}" alt="Avatar"
                         style="border-radius: 50%;width: 160px;height: 160px;object-fit: cover;">
                </div>

                <div class="profile-information-cont-client">

                    <div class="user-display-name">
                        {{ request.user.first_name }} {{ request.user.last_name }}
                    </div>

                  <div class="span-user-type">

                    {% if user.profile.type == 0 %}
                      Клиент
                    {% endif %}

                  </div>



                    <div class="user-settings">

                        <a href="{% url 'profile_edit' %}" type="button"
                           class="btn prof-settings-btn">
                            Настройки профиля
                        </a>

                        <a href="{% url 'profile_edit' %}" type="button"
                           class="btn prof-logout-btn">
                            Выйти
                        </a>

                    </div>

                </div>

            </div>

            <div class="bottom-half">

                <div class="prof-content-links-cont">
                  <div class="profile-menu-item" data-content="articles" onclick="showContent('articles')">Статьи &nbsp;<span class="expert-profile-title-content-number">{{ experts_articles_count }}</span></div>
                  <div class="profile-menu-item" data-content="researches" onclick="showContent('researches')">Исследования &nbsp;<span class="expert-profile-title-content-number">{{ experts_researches_count }}</span></div>
                  <div class="profile-menu-item" data-content="questions" onclick="showContent('questions')">Вопросы &nbsp;<span class="expert-profile-title-content-number">{{ experts_questions_count }}</span></div>
                  <div class="profile-menu-item" data-content="consultations" onclick="showContent('consultations')">Консультации</div>
                  <div class="profile-menu-item" data-content="notifications" onclick="showContent('notifications')">Уведомления</div>
                </div>
                
                <div id="articles" class="expert-content" style="display: none;">
                    {% for article in experts_articles %}
                        <div class="expert-content-cont">
                            <span class="article-title-loop-exp"><a href="{% url 'article_detail' article.slug %}" style="text-decoration: none;color: #36364b;">
                                {{ article.title }}</a>
                            </span>
                            <span class="article-content-loop-exp">
                                {{ article.content }}
                            </span>
                
                            <div class="article-comments-andshare-cont-exp">
                                <div class="article-comments-exp">
                                    <i class="bi bi-chat-left-text" style="color:grey;"></i>
                                    &nbsp; 104
                                </div>
                                <div class="article-share-exp">
                                    <i class="bi bi-calendar2-week" style="color:grey; "></i>
                                    &nbsp;  {{ article.time_update|custom_time_display }}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                
                <div id="researches" class="expert-content" style="display: none;">
                  <span>test research</span>
                  {% for research in experts_researches %}
                  {% endfor %}
                </div>

                <div id="questions" class="expert-content" style="display: none;">
                  <span>test questions</span>
                  {% for research in experts_researches %}
                  {% endfor %}
                </div>

                <div id="consultations" class="expert-content" style="display: none;">
                  <span>test consultations</span>
                  {% for research in experts_researches %}
                  {% endfor %}
                </div>

                <div id="reviews" class="expert-content" style="display: none;">
                  <span>test reviews</span>
                  {% for research in experts_researches %}
                  {% endfor %}
                </div>
                <div id="notifications" class="expert-content" style="display: none;">
                  <span>test notifications</span>
                  {% for research in experts_researches %}
                  {% endfor %}
                </div>

            </div>
        </div>
    </div>


    <script>
      function showContent(contentId) {
        var contentBlocks = document.getElementsByClassName('expert-content');
    
        for (var i = 0; i < contentBlocks.length; i++) {
          contentBlocks[i].style.display = 'none';
        }
    
        var menuItems = document.getElementsByClassName('profile-menu-item');
    
        for (var i = 0; i < menuItems.length; i++) {
          menuItems[i].classList.remove('selected');
        }
    
        var targetElement = document.getElementById(contentId);
        targetElement.style.display = 'block';
    
        var selectedMenuItem = document.querySelector(`.profile-menu-item[data-content="${contentId}"]`);
        selectedMenuItem.classList.add('selected');
      }
    
      document.addEventListener("DOMContentLoaded", function () {
        showContent('articles');
    
        var currentUrl = window.location.pathname;
        var menuItems = document.getElementsByClassName('profile-menu-item');
    
        for (var i = 0; i < menuItems.length; i++) {
          var contentId = menuItems[i].getAttribute("data-content");
          var href = `#${contentId}`;
    
          if (currentUrl.includes(href)) {
            menuItems[i].classList.add('selected');
            showContent(contentId);
            break;
          }
        }
      });
    </script>
{% endblock %}
