<!-- article_list.html -->
{% extends 'basePostList.html' %}

{% block title %}
Статьи
{% endblock %}
{% load web_tags %}
{% load static %}
{% load comments %}
{% load comments_xtd %}

{% block posts_content %}

<style>

	.author-pic {
		width: 30px;
		height: 30px;
		border-radius: 50%;
		overflow: hidden;
		border: 1px solid #ccc;
	}

	.author-pic img {
		width: 100%;
		height: 100%;
		object-fit: cover;
	}

	@media (max-width: 768px ) {
		.article-list-search-cont {
			width: 100% !important;
		}

	}

</style>

<link rel="stylesheet" href="{% static 'web/css/article_list.css' %}">

<body>

	<div class="list-main-containers" >

		<div class="search-and-cat-cont">

			<div class="col-6">
				<input type="text" id="search-article-query" class="lists-search-cont" placeholder="Поиск" value="{{ search_q }}">
			</div>
            
			<div class="col-6 catagory-cont">
				{% include "components/post_category_filter.html" %}
			</div>


		</div>

		{% for article in articles %}

		<div class="article-list-content">
			<div class="list-publish-date">
				<i class="bi bi-calendar2-week" style="color:grey; scale:1.3"></i>
				&nbsp;  {{ article.time_update|custom_time_display }}

			</div>

			<div class="article-list-title">{{article.title}}</div>

			<div class="article-list-main-content">
				{% autoescape off %}

				<div class="artile-list-description">
					{{article.description}}
				</div>

				<div class="artile-list-description">
					{% if article.main_img %}
						<img src="{{ article.main_img.url }}" alt="Article Image" style="max-width:100%">
					{% endif %}
				</div>

				{% endautoescape %}
				<span class="link-read-post">
                    <a href="{{ article.get_absolute_url }}" class="link-read-post" style="color:black;border: 1px solid lightgray;
    padding: 5px 10px 5px 10px;">Читать пост</a>
				</span>
			
				<div class="article-list-cat-cont ">
					<div class="user-catagory-highlight {{article.cat.slug}}">
						{{ article.cat.name }}
					</div>
				</div>

				<div class="article-list-last">

					<div class="article-list-author-cont">
                       
                        <div class="author-pic">
                            <img src="{{ article.author.profile.avatar.url }}" />
						</div>


						<a href="{% url 'expert_profile' article.author.pk %}" style="text-decoration:none">
							<div class="article-list-author-name">{{ article.author.last_name }} {{ article.author.first_name }}</div>
						</a>
						
					</div>

					<div class="comments-andshare-cont">

						<div class="list-comments">
							<i class="bi bi-chat-left-text" style="color:grey;"></i>
                            {% get_comment_count for article as comment_count %}
							&nbsp;{{ comment_count }}
                        </div>

                        <div class="list-share">
							<i class="bi bi-box-arrow-up-right" style="color:grey;scale:0.9 "></i>
						</div>

					</div>

				</div>

				<hr class="solid">
				
			</div>

		</div>
		{% endfor %}
		


        <div style="display:flex; justify-content:center">
            <button type="button" class="btn btn-secondary btn-more" onclick="alert('В разработке');">
                Загрузить ещё
            </button>
        </div>

	</div>

    <script>
        document.getElementById("search-article-query").addEventListener("keypress", function(event) {
                if (event.key === "Enter") {
                    window.location.href = {{ request.path }} + '?search_q=' + this.value
                }
        })
    </script>

</body>

{% endblock %}